url<- "https://github.com/paes023bio/TrabalhoR_Marijuana_Arrests2/blob/6c7aac9946ae59fd17a903c97ac3d0759a856cb3/Marijuana_Arrests.csv"
db_Marijuana_Arrests<- read_csv(url)
library(readr)
db_Marijuana_Arrests<- read_csv(url)
url<- "https://github.com/paes023bio/TrabalhoR_Marijuana_Arrests2"
db_Marijuana_Arrests<- read_csv(url)
View(db_Marijuana_Arrests)
url<- "https://github.com/paes023bio/TrabalhoR_Marijuana_Arrests2/blob/33c8c1db26b6b074fea8ebc4ec959a2f118bfcb7/Marijuana_Arrests.csv"
db_Marijuana_Arrests<- read_csv(url)
Marijuana_Arrests <- read_csv("C:/Users/paes2/Desktop/disciplinas/Linguagem R/trabalho/TrabalhoR_Marijuana_Arrests/Marijuana_Arrests.csv")
View(Marijuana_Arrests)
library(dplyr)
Marijuana_Arrests%>%select(CATEGORY) %>% head(200)
Marijuana_Arrests%>%select(CATEGORY) %>% head(200) %>% view()
Marijuana_Arrests%>% select(CATEGORY) %>% head(200) %>% View()
Marijuana_Arrests%>% select(CATEGORY) %>% head(1000) %>% View()
()
Marijuana_Arrests%>% select(TYPE) %>% head(1000) %>% View()
library(readr)
library(dplyr)
#limpeaza dos dados
#sugestões: retirar linhas com NA; e colunas que não iram ser usadas, como GIS_ID, EDITOR, OBJECTID...
Marijuana_Arrests%>% select(c(-CCN, -OFFENSE_BLOCKX, -OFFENSE_BLOCKY,-GIS_ID, -CREATED))
#limpeaza dos dados
#sugestões: retirar linhas com NA; e colunas que não iram ser usadas, como GIS_ID, EDITOR, OBJECTID...
Marijuana_Arrests%>% select(c(-CCN, -OFFENSE_BLOCKX, -OFFENSE_BLOCKY,-GIS_ID, -CREATED)) %>% View()
Marijuana_Arrests %>% filter(DEFENDANT_PSA != 0 | DEFENDANT_DISTRICT !=0)
Marijuana_Arrests %>% filter(DEFENDANT_PSA != 0 | DEFENDANT_DISTRICT !=0 | RACE !=0 | ETHNICITY !=0)
Marijuana_Arrests %>% filter(c(DEFENDANT_PSA != 0 | DEFENDANT_DISTRICT !=0 | RACE !=0 | ETHNICITY !=0))
Marijuana_Arrests %>% filter(DEFENDANT_PSA!= 0 | DEFENDANT_DISTRICT!=0 | RACE!=0 | ETHNICITY!=0)
#limpeaza dos dados
#sugestões: retirar linhas com NA; e colunas que não iram ser usadas, como GIS_ID, EDITOR, OBJECTID...
Marijuana_Arrests%>% select(-CCN, -OFFENSE_BLOCKX, -OFFENSE_BLOCKY,-GIS_ID, -CREATED)) %>% View()
Marijuana_Arrests %>% filter(DEFENDANT_PSA!= 0 | DEFENDANT_DISTRICT!=0 | RACE!=0 | ETHNICITY!=0)
Marijuana_Arrests %>% filter(DEFENDANT_PSA!= 0 | DEFENDANT_DISTRICT!=0)
Marijuana_Arrests %>% filter(c(DEFENDANT_PSA!= 0 | DEFENDANT_DISTRICT!=0))
Marijuana_Arrests %>% filter(c(DEFENDANT_PSA!= 0 | DEFENDANT_DISTRICT!=0 | RACE!=0))
Marijuana_Arrests %>% filter(c(DEFENDANT_PSA!= 0 | DEFENDANT_DISTRICT!=0))
Marijuana_Arrests<-Marijuana_Arrests%>% select(c(-CCN, -OFFENSE_BLOCKX, -OFFENSE_BLOCKY,-GIS_ID, -CREATED)) %>% View()
Marijuana_Arrests<- Marijuana_Arrests %>% filter(c(DEFENDANT_PSA!= 0 | DEFENDANT_DISTRICT!=0))
Marijuana_Arrests <- read_csv("C:/Users/paes2/Desktop/disciplinas/Linguagem R/trabalho/TrabalhoR_Marijuana_Arrests/Marijuana_Arrests.csv")
Marijuana_Arrests<-Marijuana_Arrests%>% select(c(-CCN, -OFFENSE_BLOCKX, -OFFENSE_BLOCKY,-GIS_ID, -CREATED)) %>% View()
Marijuana_Arrests <- read_csv("C:/Users/paes2/Desktop/disciplinas/Linguagem R/trabalho/TrabalhoR_Marijuana_Arrests/Marijuana_Arrests.csv")
Marijuana_Arrests_new<-Marijuana_Arrests%>% select(c(-CCN, -OFFENSE_BLOCKX, -OFFENSE_BLOCKY,-GIS_ID, -CREATED)) %>% View()
#limpeaza dos dados
#sugestões: retirar linhas com NA; e colunas que não iram ser usadas, como GIS_ID, EDITOR, OBJECTID...
Marijuana_Arrests_new<-Marijuana_Arrests%>% select(c(-CCN, -OFFENSE_BLOCKX, -OFFENSE_BLOCKY,-GIS_ID, -CREATED))
Marijuana_Arrests_new<- Marijuana_Arrests %>% filter(c(DEFENDANT_PSA!= 0 | DEFENDANT_DISTRICT!=0))
Marijuana_Arrests_new<- Marijuana_Arrests %>% filter(c(DEFENDANT_PSA!= 0 | DEFENDANT_DISTRICT!=0))
Marijuana_Arrests_new<-Marijuana_Arrests%>% select(c(-CCN, -OFFENSE_BLOCKX, -OFFENSE_BLOCKY,-GIS_ID, -CREATED))
Marijuana_Arrests_new<- Marijuana_Arrests %>% filter(c(DEFENDANT_PSA!= 0 | DEFENDANT_DISTRICT!=0))
Marijuana_Arrests_new<- Marijuana_Arrests %>% filter(c(DEFENDANT_PSA!= 0 | DEFENDANT_DISTRICT!=0)) %>% select(c(-CCN, -OFFENSE_BLOCKX, -OFFENSE_BLOCKY,-GIS_ID, -CREATED))
View(Marijuana_Arrests_new)
View(Marijuana_Arrests_new)
Marijuana_Arrests_new<- Marijuana_Arrests %>% filter(c(DEFENDANT_PSA!= 0 | DEFENDANT_DISTRICT!=0)) %>% select(c(-CCN, -OFFENSE_BLOCKX, -OFFENSE_BLOCKY,-GIS_ID, -CREATED, -ARREST_BLOCKX, -ARREST_BLOCKY))
Marijuana_Arrests_new<- Marijuana_Arrests %>% filter(c(DEFENDANT_PSA!= 0 | DEFENDANT_DISTRICT!=0| RACE!=0)) %>% select(c(-CCN, -OFFENSE_BLOCKX, -OFFENSE_BLOCKY,-GIS_ID, -CREATED, -ARREST_BLOCKX, -ARREST_BLOCKY))
Marijuana_Arrests_new<- Marijuana_Arrests %>% filter(c(DEFENDANT_PSA!= 0 | DEFENDANT_DISTRICT!=0)) %>% select(c(-CCN, -OFFENSE_BLOCKX, -OFFENSE_BLOCKY,-GIS_ID, -CREATED, -ARREST_BLOCKX, -ARREST_BLOCKY))
Marijuana_Arrests_new<- Marijuana_Arrests %>% filter(c(DEFENDANT_PSA!= 0 , DEFENDANT_DISTRICT!=0, RACE!=0)) %>% select(c(-CCN, -OFFENSE_BLOCKX, -OFFENSE_BLOCKY,-GIS_ID, -CREATED, -ARREST_BLOCKX, -ARREST_BLOCKY))
Marijuana_Arrests_new<- Marijuana_Arrests %>% filter(c(DEFENDANT_PSA!= 0 | DEFENDANT_DISTRICT!=0 | RACE!=0)) %>% select(c(-CCN, -OFFENSE_BLOCKX, -OFFENSE_BLOCKY,-GIS_ID, -CREATED, -ARREST_BLOCKX, -ARREST_BLOCKY))
Marijuana_Arrests_new<- Marijuana_Arrests %>% filter(c(DEFENDANT_PSA!= 0 | DEFENDANT_DISTRICT!=0)) %>% select(c(-CCN, -OFFENSE_BLOCKX, -OFFENSE_BLOCKY,-GIS_ID, -CREATED, -ARREST_BLOCKX, -ARREST_BLOCKY))
#trabalho R
#################### Importação das bibliotecas ############################
library(readr)
library(dplyr)
library(tidyverse)
library(stringr)
library(ggplot2)
library(ggthemes) # pacote de temas para os gráficos ggplot2
library(tibble)
#################### Importação do conjunto de dados #######################
# Importando o banco de dados localmente (caso a url não funcione)
# Raw_Data <- read_csv("Diretório do arquivo salvo no computador")
# Importação do banco de dados remoto salvo no diretório do github
Raw_Data <- read_csv(url("https://raw.githubusercontent.com/paes023bio/TrabalhoR_Marijuana_Arrests2/main/Marijuana_Arrests.csv"))
# Variável chamada de Raw_Data por ser os dados "crus"
View(Raw_Data)
str(Raw_Data)
Raw_Data %>% select(TYPE) %>% head(1000) %>% View()
####################### Tratamento dos dados #############################
# Descrição das variáveis dos dados puros
'''
TIPO: Indica o tipo de prisão	Texto
ADULT_JUVENILE: Especifica se o detido é um adulto ou um menor	Texto
ANO:	O ano em que ocorreu a prisão	Numérico
DATA HORA:	A data e hora da prisão	Texto
CCN:	Número de hash que permite aos indivíduos determinar se há várias prisões associadas a um evento	Texto
IDADE:	A idade do detido no momento da detenção	Numérico
OFFENSE_DISTRICT:	Bairro onde ocorreu o crime	Texto
OFFENSE_PSA:	A Área de Serviço Policial (PSA) associada ao crime	Texto
OFFENSE_BLOCKX:	Coordenada X da localização aproximada do bloco da ofensa	Numérico
OFFENSE_BLOCKY:	Coordenada Y da localização aproximada do bloco da ofensa	Numérico
DEFENDANT_PSA:	O PSA associado ao réu	numérico
DEFENDANT_DISTRICT:	O distrito associado ao réu	Texto
RACE:	A raça do réu, com base na observação oficial	Texto
ETNIA:	A etnia do réu, com base na observação oficial	Texto
SEXO:	O gênero do réu	Texto
CATEGORIA:	A categoria do delito (por exemplo, posse, distribuição, consumo público)	Texto
DESCRIÇÃO:	Descrição do crime	Texto
ENDEREÇO:	O endereço do local da ofensa	Texto
ARREST_BLOCKX:	Coordenada X da localização aproximada do bloco da prisão	Numérico
ARREST_BLOCKY:	Coordenada Y da localização aproximada do bloco da prisão	Numérico
GIS_ID	ID: do Sistema de Informações Geográficas (GIS) associado ao registro	Texto
O CRIADOR:	O criador do registro	Texto
CREATED:	A data e a hora em que o registro foi criado	Texto
EDITOR:	O editor do disco	Texto
EDITADO:	A data e a hora em que o registro foi editado pela última vez	Texto
OBJECTID:	Identificador único para cada registro	Numérico
GLOBALID:	Identificador exclusivo global para cada registro	Texto
'''
variaveis <- c("TYPE", "ADULT_JUVENILE", "DATETIME", "AGE", "RACE", "ETHNICITY", "SEX", "ADDRESS", "DEFENDANT_DISTRICT", "OFFENSE_DISTRICT")
Interest_Data <- Raw_Data %>% select(variaveis)
M <- filter(Interest_Data, TYPE!=0 & ADULT_JUVENILE!=0 & DATETIME!=0 & AGE!=0
& RACE!=0 & ETHNICITY!=0 & SEX!=0 & ADDRESS!=0 & DEFENDANT_DISTRICT!=0
& OFFENSE_DISTRICT!=0)
print(head(M, 50), n=50)
M <- M %>% separate(DATETIME, into = c("ANO", "MES", "DIAHORA"), sep="/")
M <- M %>% separate(DIAHORA, into = c("DIA", "HORA"), sep=" ")
M <- M %>% mutate(TYPE = str_to_title(M$TYPE))
tipo_delito<- M %>%
group_by(TYPE) %>%
summarise("Numero_De_Delitos" = n())
tipo_delito %>%select(Numero_De_Delitos) %>% max()
paste0("O maior tipo de delito de apreensão é posse de maconha, com:  ", tipo_delito$Numero_De_Delitos[4])
ocal_apreensoes_posse<- M %>% group_by(OFFENSE_DISTRICT,TYPE) %>%
summarise("Numero_De_apreensões" = n()) %>%
filter(str_detect(TYPE,pattern = "Possession$"))
local_apreensoes_posse<- local_apreensoes_posse %>% select(OFFENSE_DISTRICT, Numero_De_apreensões)%>% arrange(Numero_De_apreensões)
local_apreensoes_posse<- M %>% group_by(OFFENSE_DISTRICT,TYPE) %>%
summarise("Numero_De_apreensões" = n()) %>%
filter(str_detect(TYPE,pattern = "Possession$"))
local_apreensoes_posse<- local_apreensoes_posse %>% select(OFFENSE_DISTRICT, Numero_De_apreensões)%>% arrange(Numero_De_apreensões)
paste0("O distrito em que ocorre o maior número de apreensões por posse é: ", local_apreensoes_posse$OFFENSE_DISTRICT[8], ", com: ", local_apreensoes_posse$Numero_De_apreensões[8])
dist_posse_traf<- M %>% group_by(OFFENSE_DISTRICT,TYPE) %>%
summarise("Numero_De_apreensões" = n()) %>%
filter(str_detect(TYPE,pattern = "Possession"))
dist_posse_traf<- rename(dist_posse_traf, c(Distritos= OFFENSE_DISTRICT, Tipo_de_Delito=TYPE))#alterando o nome de algumas colunas para o português
dist_posse_traf<- dist_posse_traf%>% filter(str_detect(Distritos,pattern = ".D$"))#tirando os delitos comentidos fora do Estado
gf_Posse_traf_dist<- dist_posse_traf %>% ggplot(aes(x=Distritos, y=Numero_De_apreensões, color=Tipo_de_Delito)) + geom_point()+
labs(title = "Posse e Tráfico de Maconha por Distritos Dentro do Estado", x="Distritos", y="Número de Apreensões", color="Tipo de Delito")+
scale_alpha_discrete(name="tipo de delito", labels=c("Posse","Tráfico"))+
theme(plot.title = element_text(size = 9,hjust=0.5), panel.background = element_rect(fill = "grey98"))
gf_Posse_traf_dist #problema em utilizar a funçao scale_alpha_discrete para alterar as labels da legenda para o português
#vou mexer mais no gráfico depois
Interest_Data <- Interest_Data %>% mutate(TYPE = str_to_title(Interest_Data$TYPE))
adult_juvenile_rate <- Interest_Data %>%
group_by(TYPE) %>%
summarise("Numero_De_Delitos" = n())
adult_juvenile_rate
num_maiores <- Interest_Data %>%
group_by(TYPE) %>%
filter(ADULT_JUVENILE == "Adult") %>%
summarise("Maiores_De_Idade" = n()) %>%
select("Maiores_De_Idade")
adult_juvenile_rate <- adult_juvenile_rate %>% mutate(num_maiores)
num_menores <- Interest_Data %>%
group_by(TYPE) %>%
filter(ADULT_JUVENILE == "Juvenile") %>%
summarise("Menores_De_Idade" = n()) %>%
select("Menores_De_Idade")
num_menores <- num_menores %>% add_row("Menores_De_Idade" = 0, .before = 1)
num_menores <- num_menores %>% add_row("Menores_De_Idade" = 0, .before = 3)
adult_juvenile_rate <- adult_juvenile_rate %>% mutate(num_menores)
idade_des <- Interest_Data %>%
group_by(TYPE) %>%
filter(ADULT_JUVENILE == "Unknown") %>%
summarise("Idade_Desconhecida" = n()) %>%
select("Idade_Desconhecida")
idade_des  <- idade_des   %>% add_row("Idade_Desconhecida" = 0, .before = 1)
idade_des  <- idade_des   %>% add_row("Idade_Desconhecida" = 0, .before = 3)
adult_juvenile_rate <- adult_juvenile_rate %>% mutate(idade_des)
# Tabela Pronta
adult_juvenile_rate
names <- adult_juvenile_rate %>% names()
values <- adult_juvenile_rate %>% slice(1) %>% unname() %>% unlist() %>% as.integer()
dados <- data.frame(Faixa_Etaria = names[-c(1,2)],
valores = values[-c(1,2)])
names
ggplot(dados, aes(x = "", y = valores, fill = Faixa_Etaria)) +
geom_bar(stat = "identity", width = 1) +
coord_polar(theta = "y") +
labs(fill = "Categoria") +
theme_minimal()
adult_juvenile_rate
gf_Posse_traf_dist #problema em utilizar a funçao scale_alpha_discrete para alterar as labels da legenda para o português
gf_Posse_traf_dist + ggplot2::geom_smooth()
gf_Posse_traf_dist + ggplot2::geom_smooth(  mapping = NULL,
data = NULL,
stat = "smooth",
position = "identity",)
gf_Posse_traf_dist + ggplot2::geom_smooth(  mapping = NULL,data = NULL,stat = "lm",position = "identity",)
gf_Posse_traf_dist + ggplot2::geom_smooth(  mapping = NULL,data = NULL,stat = "lm",position = "identity")
gf_Posse_traf_dist + ggplot2::geom_smooth(stat = "lm")
gf_Posse_traf_dist + ggplot2::geom_smooth(method = "lm", se = F)
dist_posse_traf %>% ggplot(aes(x=Distritos, y=Numero_De_apreensões, color=Tipo_de_Delito, bindwith= 0.2)) + geom_point()+
labs(title = "Posse e Tráfico de Maconha por Distritos Dentro do Estado", x="Distritos", y="Número de Apreensões", color="Tipo de Delito")+
scale_alpha_discrete(name="tipo de delito", labels=c("Posse","Tráfico"))+
theme(plot.title = element_text(size = 9,hjust=0.5), panel.background = element_rect(fill = "grey98"))
library(readr)
library(dplyr)
library(tidyverse)
library(stringr)
library(ggplot2)
library(ggthemes) # pacote de temas para os gráficos ggplot2
library(tibble)
Raw_Data %>% select(TYPE) %>% head(1000) %>% View()
variaveis <- c("TYPE", "ADULT_JUVENILE", "DATETIME", "AGE", "RACE", "ETHNICITY", "SEX", "ADDRESS", "DEFENDANT_DISTRICT", "OFFENSE_DISTRICT")
Interest_Data <- Raw_Data %>% select(variaveis)
M <- filter(Interest_Data, TYPE!=0 & ADULT_JUVENILE!=0 & DATETIME!=0 & AGE!=0
& RACE!=0 & ETHNICITY!=0 & SEX!=0 & ADDRESS!=0 & DEFENDANT_DISTRICT!=0
& OFFENSE_DISTRICT!=0)
M <- M %>% separate(DATETIME, into = c("ANO", "MES", "DIAHORA"), sep="/")
M <- M %>% separate(DIAHORA, into = c("DIA", "HORA"), sep=" ")
M <- M %>% mutate(TYPE = str_to_title(M$TYPE))
tipo_delito<- M %>%
group_by(TYPE) %>%
summarise("Numero_De_Delitos" = n())
tipo_delito %>%select(Numero_De_Delitos) %>% max()
paste0("O maior tipo de delito de apreensão é posse de maconha, com:  ", tipo_delito$Numero_De_Delitos[4])
local_apreensoes_posse<- M %>% group_by(OFFENSE_DISTRICT,TYPE) %>%
summarise("Numero_De_apreensões" = n()) %>%
filter(str_detect(TYPE,pattern = "Possession$"))
local_apreensoes_posse<- local_apreensoes_posse %>% select(OFFENSE_DISTRICT, Numero_De_apreensões)%>% arrange(Numero_De_apreensões)
paste0("O distrito em que ocorre o maior número de apreensões por posse é: ", local_apreensoes_posse$OFFENSE_DISTRICT[8], ", com: ", local_apreensoes_posse$Numero_De_apreensões[8])
dist_posse_traf<- M %>% group_by(OFFENSE_DISTRICT,TYPE) %>%
summarise("Numero_De_apreensões" = n()) %>%
filter(str_detect(TYPE,pattern = "Possession"))
dist_posse_traf<- rename(dist_posse_traf, c(Distritos= OFFENSE_DISTRICT, Tipo_de_Delito=TYPE))#alterando o nome de algumas colunas para o português
dist_posse_traf<- dist_posse_traf%>% filter(str_detect(Distritos,pattern = ".D$"))#tirando os delitos comentidos fora do Estado
gf_Posse_traf_dist<- dist_posse_traf %>% ggplot(aes(x=Distritos, y=Numero_De_apreensões, color=Tipo_de_Delito)) + geom_point()+
labs(title = "Posse e Tráfico de Maconha por Distritos Dentro do Estado", x="Distritos", y="Número de Apreensões", color="Tipo de Delito")+
scale_alpha_discrete(name="tipo de delito", labels=c("Posse","Tráfico"))+
theme(plot.title = element_text(size = 9,hjust=0.5), panel.background = element_rect(fill = "grey98"))
gf_Posse_traf_dist #problema em utilizar a funçao scale_alpha_discrete para alterar as labels da legenda para o português
#vou mexer mais no gráfico depois
dist_posse_traf %>% ggplot(aes(x=Distritos, y=Numero_De_apreensões, color=Tipo_de_Delito),  binwidth = 0.2) + geom_point()+
labs(title = "Posse e Tráfico de Maconha por Distritos Dentro do Estado", x="Distritos", y="Número de Apreensões", color="Tipo de Delito")+
scale_alpha_discrete(name="tipo de delito", labels=c("Posse","Tráfico"))+
theme(plot.title = element_text(size = 9,hjust=0.5), panel.background = element_rect(fill = "grey98"))
dist_posse_traf %>% ggplot(aes(x=Distritos, y=Numero_De_apreensões, color=Tipo_de_Delito),  binwidth = 0.7) + geom_point()+
labs(title = "Posse e Tráfico de Maconha por Distritos Dentro do Estado", x="Distritos", y="Número de Apreensões", color="Tipo de Delito")+
scale_alpha_discrete(name="tipo de delito", labels=c("Posse","Tráfico"))+
theme(plot.title = element_text(size = 9,hjust=0.5), panel.background = element_rect(fill = "grey98"))
gf_Posse_traf_dist+  scale_alpha_discrete(name="tipo de delito", labels=c("Posse","Tráfico"))+
gf_Posse_traf_dist+  scale_alpha_discrete(name="tipo de delito", labels=c("Posse","Tráfico"))
gf_Posse_traf_dist + scale_fill_manual ( values ​​= c ( "#1b98e0" , "yellow"" ),guia = guia_legenda ( reverse =  TRU))
gf_Posse_traf_dist + scale_fill_manual (values ​​= c ( "#1b98e0" , "yellow" ),guia = guia_legenda ( reverse =T))
gf_Posse_traf_dist + scale_fill_manual(name=tipo de delito, labels=c("Posse","Tráfico"))
gf_Posse_traf_dist<- dist_posse_traf %>% ggplot(aes(x=Distritos, y=Numero_De_apreensões, color=Tipo_de_Delito)) + geom_point()+
labs(title = "Posse e Tráfico de Maconha por Distritos Dentro do Estado", x="Distritos", y="Número de Apreensões", color="Tipo de Delito")+
theme(plot.title = element_text(size = 9,hjust=0.5), panel.background = element_rect(fill = "grey98"))
gf_Posse_traf_dist
gf_Posse_traf_dist+ scale_fill_manual(name=tipo de delito, labels=c("Posse","Tráfico"))
gf_Posse_traf_dist+ scale_alpha_discrete(name="tipo de delito", labels=c("Posse","Tráfico")) #problema em utilizar a funçao scale_alpha_discrete para alterar as labels da legenda para o português
View(dist_posse_traf)
gf_Posse_traf_dist+ theme(legend.position="bottom")
gf_Posse_traf_dist<- dist_posse_traf %>% ggplot(aes(x=Distritos, y=Numero_De_apreensões, color=Tipo_de_Delito)) + geom_point()+
labs(title = "Posse e Tráfico de Maconha por Distritos Dentro do Estado", x="Distritos", y="Número de Apreensões", color="Tipo de Delito")+
theme(plot.title = element_text(size = 9,hjust=0.5),
panel.background = element_rect(fill = "grey98"),legend.position = "bottom")
gf_Posse_traf_dist+ scale_alpha_discrete(name="tipo de delito", labels=c("Posse","Tráfico")) #problema em utilizar a funçao scale_alpha_discrete para alterar as labels da legenda para o português
gf_Posse_traf_dist<- dist_posse_traf %>% ggplot(aes(x=Distritos, y=Numero_De_apreensões, color=Tipo_de_Delito)) + geom_point()+
labs(title = "Posse e Tráfico de Maconha por Distritos Dentro do Estado", x="Distritos", y="Número de Apreensões", color="Tipo de Delito")+
theme(plot.title = element_text(size = 12,hjust=0.5),
panel.background = element_rect(fill = "grey98"),legend.position = "bottom")
gf_Posse_traf_dist+ scale_alpha_discrete(name="tipo de delito", labels=c("Posse","Tráfico")) #problema em utilizar a funçao scale_alpha_discrete para alterar as labels da legenda para o português
gf_Posse_traf_dist<- dist_posse_traf %>% ggplot(aes(x=Distritos, y=Numero_De_apreensões, color=Tipo_de_Delito)) + geom_point()+
labs(title = "Posse e Tráfico de Maconha por Distritos Dentro do Estado", x="Distritos", y="Número de Apreensões", color="Tipo de Delito", size= 0.5)+
theme(plot.title = element_text(size = 12,hjust=0.5),
panel.background = element_rect(fill = "grey98"),legend.position = "bottom")
gf_Posse_traf_dist+ scale_alpha_discrete(name="tipo de delito", labels=c("Posse","Tráfico")) #problema em utilizar a funçao scale_alpha_discrete para alterar as labels da legenda para o português
gf_Posse_traf_dist<- dist_posse_traf %>% ggplot(aes(x=Distritos, y=Numero_De_apreensões, color=Tipo_de_Delito)) + geom_point()+
labs(title = "Posse e Tráfico de Maconha por Distritos Dentro do Estado", x="Distritos", y="Número de Apreensões", color="Tipo de Delito", size= 8)+
theme(plot.title = element_text(size = 12,hjust=0.5),
panel.background = element_rect(fill = "grey98"),legend.position = "bottom")
gf_Posse_traf_dist+ scale_alpha_discrete(name="tipo de delito", labels=c("Posse","Tráfico"))
dist_posse_traf<- dist_posse_traf%>% filter(str_detect(Distritos,pattern = ".D$"))#tirando os delitos comentidos fora do Estado
gf_Posse_traf_dist<- dist_posse_traf %>% ggplot(aes(x=Distritos, y=Numero_De_apreensões, color=Tipo_de_Delito)) + geom_point()+
labs(title = "Posse e Tráfico de Maconha por Distritos Dentro do Estado", x="Distritos", y="Número de Apreensões", color="Tipo de Delito")+
gf_Posse_traf_dist+ theme(plot.title = element_text(size = 12,hjust=0.5),
panel.background = element_rect(fill = "grey98"),legend.position = "bottom")
gf_Posse_traf_dist+ theme(plot.title = element_text(size = 12,hjust=0.5),
panel.background = element_rect(fill = "grey98"),legend.position = "bottom")
gf_Posse_traf_dist<- dist_posse_traf %>% ggplot(aes(x=Distritos, y=Numero_De_apreensões, color=Tipo_de_Delito)) + geom_point()+
labs(title = "Posse e Tráfico de Maconha por Distritos Dentro do Estado",
x="Distritos", y="Número de Apreensões", color="Tipo de Delito", size=8)
gf_Posse_traf_dist+ theme(plot.title = element_text(size = 12,hjust=0.5),
panel.background = element_rect(fill = "grey98"),legend.position = "bottom")
gf_Posse_traf_dist<- dist_posse_traf %>% ggplot(aes(x=Distritos, y=Numero_De_apreensões, color=Tipo_de_Delito)) + geom_point()+
labs(title = "Posse e Tráfico de Maconha por Distritos Dentro do Estado",
x="Distritos", y="Número de Apreensões", color="Tipo de Delito", size=8, shape=2)
gf_Posse_traf_dist+ theme(plot.title = element_text(size = 12,hjust=0.5),
panel.background = element_rect(fill = "grey98"),legend.position = "bottom")
gf_Posse_traf_dist<- dist_posse_traf %>% ggplot(aes(x=Distritos, y=Numero_De_apreensões, color=Tipo_de_Delito)) + geom_point(size=8, shape=2)+
labs(title = "Posse e Tráfico de Maconha por Distritos Dentro do Estado",
x="Distritos", y="Número de Apreensões", color="Tipo de Delito")
gf_Posse_traf_dist+ theme(plot.title = element_text(size = 12,hjust=0.5),
panel.background = element_rect(fill = "grey98"),legend.position = "bottom")
gf_Posse_traf_dist<- dist_posse_traf %>% ggplot(aes(x=Distritos, y=Numero_De_apreensões, color=Tipo_de_Delito)) + geom_point(size=2, shape=2)+
labs(title = "Posse e Tráfico de Maconha por Distritos Dentro do Estado",
x="Distritos", y="Número de Apreensões", color="Tipo de Delito")
gf_Posse_traf_dist+ theme(plot.title = element_text(size = 12,hjust=0.5),
panel.background = element_rect(fill = "grey98"),legend.position = "bottom")
gf_Posse_traf_dist<- dist_posse_traf %>% ggplot(aes(x=Distritos, y=Numero_De_apreensões, color=Tipo_de_Delito)) + geom_point(size=2, shape=Tipo_de_Delito)+
labs(title = "Posse e Tráfico de Maconha por Distritos Dentro do Estado",
x="Distritos", y="Número de Apreensões", color="Tipo de Delito")
gf_Posse_traf_dist<- dist_posse_traf %>% ggplot(aes(x=Distritos, y=Numero_De_apreensões, color=Tipo_de_Delito)) + geom_point(size=2, shape="Tipo_de_Delito")+
labs(title = "Posse e Tráfico de Maconha por Distritos Dentro do Estado",
x="Distritos", y="Número de Apreensões", color="Tipo de Delito")
gf_Posse_traf_dist+ theme(plot.title = element_text(size = 12,hjust=0.5),
panel.background = element_rect(fill = "grey98"),legend.position = "bottom")
gf_Posse_traf_dist<- dist_posse_traf %>% ggplot(aes(x=Distritos, y=Numero_De_apreensões, color=Tipo_de_Delito)) + geom_point(size=2, shape=c(1,2))+
labs(title = "Posse e Tráfico de Maconha por Distritos Dentro do Estado",
x="Distritos", y="Número de Apreensões", color="Tipo de Delito")
gf_Posse_traf_dist+ theme(plot.title = element_text(size = 12,hjust=0.5),
panel.background = element_rect(fill = "grey98"),legend.position = "bottom")
gf_Posse_traf_dist<- dist_posse_traf %>% ggplot(aes(x=Distritos, y=Numero_De_apreensões, color=Tipo_de_Delito)) + geom_point(size=2, shape=c4)+
labs(title = "Posse e Tráfico de Maconha por Distritos Dentro do Estado",
x="Distritos", y="Número de Apreensões", color="Tipo de Delito")
gf_Posse_traf_dist<- dist_posse_traf %>% ggplot(aes(x=Distritos, y=Numero_De_apreensões, color=Tipo_de_Delito)) + geom_point(size=2, shape=4)+
labs(title = "Posse e Tráfico de Maconha por Distritos Dentro do Estado",
x="Distritos", y="Número de Apreensões", color="Tipo de Delito")
gf_Posse_traf_dist+ theme(plot.title = element_text(size = 12,hjust=0.5),
panel.background = element_rect(fill = "grey98"),legend.position = "bottom")
gf_Posse_traf_dist<- dist_posse_traf %>% ggplot(aes(x=Distritos, y=Numero_De_apreensões, color=Tipo_de_Delito)) + geom_point(size=2, shape=Platform)+
labs(title = "Posse e Tráfico de Maconha por Distritos Dentro do Estado",
x="Distritos", y="Número de Apreensões", color="Tipo de Delito")
gf_Posse_traf_dist<- dist_posse_traf %>% ggplot(aes(x=Distritos, y=Numero_De_apreensões, color=Tipo_de_Delito)) + geom_point(size=2, shape=tipo_delito)+
labs(title = "Posse e Tráfico de Maconha por Distritos Dentro do Estado",
x="Distritos", y="Número de Apreensões", color="Tipo de Delito")
gf_Posse_traf_dist+ theme(plot.title = element_text(size = 12,hjust=0.5),
panel.background = element_rect(fill = "grey98"),legend.position = "bottom")
View(gf_Posse_traf_dist)
View(dist_posse_traf)
gf_Posse_traf_dist<- dist_posse_traf %>% ggplot(aes(x=Distritos, y=Numero_De_apreensões, color=Tipo_de_Delito)) + geom_point(size=2, shape=Tipo_de_Delito)+
labs(title = "Posse e Tráfico de Maconha por Distritos Dentro do Estado",
x="Distritos", y="Número de Apreensões", color="Tipo de Delito")
gf_Posse_traf_dist<- dist_posse_traf %>% ggplot(aes(x=Distritos, y=Numero_De_apreensões, color=Tipo_de_Delito)) + geom_point(size=2, shape=Tipo_de_Delito)+
labs(title = "Posse e Tráfico de Maconha por Distritos Dentro do Estado",
x="Distritos", y="Número de Apreensões", color="Tipo de Delito")
gf_Posse_traf_dist<- dist_posse_traf %>% ggplot(aes(x=Distritos, y=Numero_De_apreensões, color=Tipo_de_Delito)) + geom_point(size=2, shape=3)+
labs(title = "Posse e Tráfico de Maconha por Distritos Dentro do Estado",
x="Distritos", y="Número de Apreensões", color="Tipo de Delito")
gf_Posse_traf_dist+ theme(plot.title = element_text(size = 12,hjust=0.5),
panel.background = element_rect(fill = "grey98"),legend.position = "bottom")
gf_Posse_traf_dist<- dist_posse_traf %>% ggplot(aes(x=Distritos, y=Numero_De_apreensões, color=Tipo_de_Delito)) + geom_point(size=2, shape=4)+
labs(title = "Posse e Tráfico de Maconha por Distritos Dentro do Estado",
x="Distritos", y="Número de Apreensões", color="Tipo de Delito")
gf_Posse_traf_dist+ theme(plot.title = element_text(size = 12,hjust=0.5),
panel.background = element_rect(fill = "grey98"),legend.position = "bottom")
gf_Posse_traf_dist<- dist_posse_traf %>% ggplot(aes(x=Distritos, y=Numero_De_apreensões, color=Tipo_de_Delito)) + geom_point(size=2, shape=120)+
labs(title = "Posse e Tráfico de Maconha por Distritos Dentro do Estado",
x="Distritos", y="Número de Apreensões", color="Tipo de Delito")
gf_Posse_traf_dist+ theme(plot.title = element_text(size = 12,hjust=0.5),
panel.background = element_rect(fill = "grey98"),legend.position = "bottom")
gf_Posse_traf_dist<- dist_posse_traf %>% ggplot(aes(x=Distritos, y=Numero_De_apreensões, color=Tipo_de_Delito)) + geom_point(size=4, shape=120)+
labs(title = "Posse e Tráfico de Maconha por Distritos Dentro do Estado",
x="Distritos", y="Número de Apreensões", color="Tipo de Delito")
gf_Posse_traf_dist+ theme(plot.title = element_text(size = 12,hjust=0.5),
panel.background = element_rect(fill = "grey98"),legend.position = "bottom")
gf_Posse_traf_dist<- dist_posse_traf %>% ggplot(aes(x=Distritos, y=Numero_De_apreensões, color=Tipo_de_Delito)) + geom_point(size=4, shape=120)+
labs(title = "Posse e Tráfico de Maconha por Distritos Dentro do Estado",
x="Distritos", y="Número de Apreensões", color="Tipo de Delito")
gf_Posse_traf_dist+ theme(plot.title = element_text(size = 12,hjust=0.5),
panel.background = element_rect(fill = "grey98"),legend.position = "bottom")
gf_Posse_traf_dist+ theme(plot.title = element_text(size = 12,hjust=0.5),
panel.background = element_rect(fill = "grey98"),legend.position = "bottom")+
scale_fill_manual(name="Tipo", values=c("red", "blue"),
labels=c("Posse", "Tráfico"))
gf_Posse_traf_dist+ theme(plot.title = element_text(size = 12,hjust=0.5),
panel.background = element_rect(fill = "grey98"),legend.position = "bottom")+
scale_fill_manual(name="Tipo", values=c("red", "blue"),
labels=c("Posse", "Tráfico"))
gf_Posse_traf_dist+ theme(plot.title = element_text(size = 12,hjust=0.5),
panel.background = element_rect(fill = "grey98"),legend.position = "bottom")+
scale_fill_manual(name="Tipo", values=c("red", "blue"),
labels=c("Posse", "Tráfico"))
gf_Posse_traf_dist<- dist_posse_traf %>% ggplot(aes(x=Distritos, y=Numero_De_apreensões, color=Tipo_de_Delito)) +
geom_point(size=4, shape=120)+ +
scale_fill_manual(name="Tipo", values=c("red", "blue"),
labels=c("Posse", "Tráfico"))
gf_Posse_traf_dist<- dist_posse_traf %>% ggplot(aes(x=Distritos, y=Numero_De_apreensões, color=Tipo_de_Delito)) +
geom_point(size=4, shape=120)+ scale_fill_manual(name="Tipo", values=c("red", "blue"),
labels=c("Posse", "Tráfico"))
labs(title = "Posse e Tráfico de Maconha por Distritos Dentro do Estado",
x="Distritos", y="Número de Apreensões", color="Tipo de Delito")
gf_Posse_traf_dist+ theme(plot.title = element_text(size = 12,hjust=0.5),
panel.background = element_rect(fill = "grey98"),legend.position = "bottom")
gf_Posse_traf_dist<- dist_posse_traf %>% ggplot(aes(x=Distritos, y=Numero_De_apreensões, color=Tipo_de_Delito)) + geom_point(size=4, shape=120)+
labs(title = "Posse e Tráfico de Maconha por Distritos Dentro do Estado",
x="Distritos", y="Número de Apreensões", color="Tipo de Delito")
gf_Posse_traf_dist+ theme(plot.title = element_text(size = 12,hjust=0.5),
panel.background = element_rect(fill = "grey98"),legend.position = "bottom")
gf_Posse_traf_dist+ scale_fill_manual(name="Tipo", values=c("red", "blue"),
labels=c("Posse", "Tráfico"))+ theme(plot.title = element_text(size = 12,hjust=0.5),
panel.background = element_rect(fill = "grey98"),legend.position = "bottom")
gf_Posse_traf_dist<- dist_posse_traf %>% ggplot(aes(x=Distritos, y=Numero_De_apreensões, color=Tipo_de_Delito)) + geom_point(size=4, shape=120)+
labs(title = "Posse e Tráfico de Maconha por Distritos Dentro do Estado",
x="Distritos", y="Número de Apreensões")
gf_Posse_traf_dist+ scale_fill_manual(name="Tipo", values=c("red", "blue"),
labels=c("Posse", "Tráfico"))+ theme(plot.title = element_text(size = 12,hjust=0.5),
panel.background = element_rect(fill = "grey98"),legend.position = "bottom")
gf_Posse_traf_dist<- dist_posse_traf %>% ggplot(aes(x=Distritos, y=Numero_De_apreensões, color=Tipo_de_Delito)) + geom_point(size=4, shape=120)+
labs(title = "Posse e Tráfico de Maconha por Distritos Dentro do Estado",
x="Distritos", y="Número de Apreensões")
gf_Posse_traf_dist+ scale_fill_manual(name="Tipo", values=c("red", "blue"),
labels=c("Posse", "Tráfico"))+ theme(plot.title = element_text(size = 12,hjust=0.5),
panel.background = element_rect(fill = "grey98"),legend.position = "bottom")
gf_Posse_traf_dist<- dist_posse_traf %>% ggplot(aes(x=Distritos, y=Numero_De_apreensões, color=Tipo_de_Delito)) + geom_point(size=4, shape=120)+
labs(title = "Posse e Tráfico de Maconha por Distritos Dentro do Estado",
x="Distritos", y="Número de Apreensões", color="Tipo")
gf_Posse_traf_dist+ scale_fill_manual(name="Tipo", values=c("red", "blue"),
labels=c("Posse", "Tráfico"))+ theme(plot.title = element_text(size = 12,hjust=0.5),
panel.background = element_rect(fill = "grey98"),legend.position = "bottom")
dist_posse_traf%>% str_replace(Tipo_de_Delito,pattern="Possession$", replacement ="Posse")
dist_posse_traf %>% str_replace(pattern="Possession$", replacement ="Posse")
dist_posse_traf %>% str_replace(pattern="Possession$", replacement ="Posse")%>% view()
dist_posse_traf %>% filter(str_replace(pattern="Possession$", replacement ="Posse"))%>% view()
dist_posse_traf %>% filter(str_detect(Tipo_de_Delito, pattern="Possession$"))%>% view()
dist_posse_traf %>% filter(str_detect(Tipo_de_Delito, pattern="Possession$"))%>% str_replace(pattern="Possession$", replacement ="Posse")%>% view()
dist_posse_traf %>% filter(str_detect(Tipo_de_Delito, pattern="Possession$"))%>% str_replace(replacement ="Posse")%>% view()
dist_posse_traf %>% filter(str_detect(Tipo_de_Delito, pattern="Possession$"))%>% str_replace_all(pattern="Possession$", replacement ="Posse")%>% view()
dist_posse_traf %>% filter(str_detect(Tipo_de_Delito, pattern="Possession$"))%>% str_replace_all(pattern="Posse", replacement ="Possession$")%>% view()
dist_posse_traf %>% filter(str_detect(Tipo_de_Delito, pattern="Possession"))%>% str_replace_all(pattern="Possession$", replacement ="Posse")%>% view()
View(Raw_Data)
M %>% group_by(OFFENSE_DISTRICT,TYPE) %>%
summarise("Numero_De_apreensões" = n())
M %>% group_by(OFFENSE_DISTRICT,TYPE) %>%
summarise("Numero_De_apreensões" = n())%>% view()
#scale_alpha_discrete(name="tipo de delito", labels=c("Posse","Tráfico")) #problema em utilizar a funçao scale_alpha_discrete para alterar as labels da legenda para o português
#vou mexer mais no gráfico depois
####################################################################################
# 2. Qual o distrito que ocorre mais apreensões (coluna OFFENSE_DISTRICT)? qual o distrito com o maior número de detentos(coluna DEFENDANT_DISTRICT)?
M %>% group_by(OFFENSE_DISTRICT,TYPE) %>%
summarise("Numero_De_apreensões" = n())%>% max()
M %>% group_by(OFFENSE_DISTRICT,TYPE) %>%
summarise("Numero_De_apreensões" = n())
M %>% group_by(OFFENSE_DISTRICT,TYPE) %>%
summarise("Numero_De_apreensões" = n())%>% sum()
M %>% group_by(OFFENSE_DISTRICT,TYPE) %>%
summarise("Numero_De_apreensões" = n())
#scale_alpha_discrete(name="tipo de delito", labels=c("Posse","Tráfico")) #problema em utilizar a funçao scale_alpha_discrete para alterar as labels da legenda para o português
#vou mexer mais no gráfico depois
####################################################################################
# 2. Qual o distrito que ocorre mais apreensões (coluna OFFENSE_DISTRICT)? qual o distrito com o maior número de detentos(coluna DEFENDANT_DISTRICT)?
M %>% group_by(OFFENSE_DISTRICT) %>%
summarise("Numero_De_apreensões" = n())
#scale_alpha_discrete(name="tipo de delito", labels=c("Posse","Tráfico")) #problema em utilizar a funçao scale_alpha_discrete para alterar as labels da legenda para o português
#vou mexer mais no gráfico depois
####################################################################################
# 2. Qual o distrito que ocorre mais apreensões (coluna OFFENSE_DISTRICT)? qual o distrito com o maior número de detentos(coluna DEFENDANT_DISTRICT)?
n_apDist<-M %>% group_by(OFFENSE_DISTRICT) %>%
summarise("Numero_De_apreensões" = n())%>% arrange()
n_apDist<-M %>% group_by(OFFENSE_DISTRICT) %>%
summarise("Numero_De_apreensões" = n())%>% arrange()
#scale_alpha_discrete(name="tipo de delito", labels=c("Posse","Tráfico")) #problema em utilizar a funçao scale_alpha_discrete para alterar as labels da legenda para o português
#vou mexer mais no gráfico depois
####################################################################################
# 2. Qual o distrito que ocorre mais apreensões (coluna OFFENSE_DISTRICT)? qual o distrito com o maior número de detentos(coluna DEFENDANT_DISTRICT)?
n_apDist<-M %>% group_by(OFFENSE_DISTRICT) %>%
summarise("Numero_De_apreensões" = n())
n_apDist
n_apDist%>% arrange(Numero_De_apreensões)
n_apDist%>% max(Numero_De_apreensões)
max(n_apDist$Numero_De_apreensões)
paste0(max("o valor é: ",n_apDist$Numero_De_apreensões))
paste0("o valor é: ", max(n_apDist$Numero_De_apreensões))
paste0("7D: ", max(n_apDist$Numero_De_apreensões))
M %>% group_by(DEFENDANT_DISTRICT) %>%
summarise("Numero_De_Detentos" = n())
M %>% group_by(DEFENDANT_DISTRICT) %>%
summarise("Numero_De_Detentos" = n())%>% arrange()
n_dtDist<- M %>% group_by(DEFENDANT_DISTRICT) %>%
summarise("Numero_De_Detentos" = n())
max(n_dtDist$Numero_De_Detentos)
paste0("7D: ", max(max(n_dtDist$Numero_De_Detentos)))
paste0("7D: ", max(max(n_dtDist$Numero_De_Detentos)), " detentos")
View(Raw_Data)
